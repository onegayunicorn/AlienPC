name: Omega Council Validation
on: [pull_request, push]

jobs:
  validate-omega:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Check GPG Signatures on Commits
        run: |
          # Verify all commits in the PR are signed
          git log --show-signature --pretty="format:%G?" | grep -q "G" || exit 1

      - name: Verify Omega Scaffold
        run: |
          REQUIRED_FILES=(
            "council/proposals/dmd-healing-protocol-v1.md"
            "docs/BRANCH_STRATEGY.md"
            "codex-spec.yml"
          )
          for file in "${REQUIRED_FILES[@]}"; do
            if [ ! -f "$file" ]; then
              echo "❌ Missing required file: $file"
              exit 1
            fi
          done
          echo "✅ Omega scaffold verified."

      - name: Council Quorum Simulation
        run: |
          python council/simulations/kaleidoscope/council_dashboard.py --check-only
